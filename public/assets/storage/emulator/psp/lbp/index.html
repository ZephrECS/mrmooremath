<html>
	<head>
		<style>
			body {
				overflow: hidden;
				background: #000000;
				margin-top: 0;
				margin-left: 0;
				color: #000000;
			}
		</style>
		<style type="text/css">
			#button {
				display: none;
			}

			.imgb_vis {
				animation: imgb-animation 7s linear;
			}

			@keyframes imgb-animation {
				10% {
					transform: translateX(0);
				}

				20% {
					transform: translateX(100px);
				}

				90% {
					transform: translateX(100px);
				}

				100% {
					transform: translateX(0);
				}
			}
		</style>
	</head>

	<body>
		<h1 style="text-align: center; font-size: 48px" id="loadingText">
			LOADING (0/13)
		</h1>
		<div style="width: 100vw; height: 100vh; max-width: 100%">
			<div id="game" style="display: none"></div>
		</div>
		<script>
			function mergeFiles(fileParts) {
				return new Promise((resolve, reject) => {
					let buffers = [];

					function fetchPart(index) {
						if (index >= fileParts.length) {
							let mergedBlob = new Blob(buffers);
							let mergedFileUrl = URL.createObjectURL(mergedBlob);
							resolve(mergedFileUrl);
							return;
						}
						fetch(fileParts[index])
							.then((response) => response.arrayBuffer())
							.then((data) => {
								buffers.push(data);
								document.getElementById(
									"loadingText"
								).textContent = `LOADING (${index}/13)`;
								fetchPart(index + 1);
							})
							.catch(reject);
					}
					fetchPart(0);
				});
			}

			function getParts(file, start, end) {
				let parts = [];
				for (let i = start; i <= end; i++) {
					parts.push(file + ".part" + i);
				}
				return parts;
			}

			function resizeUnityContainer() {
				var container = document.getElementById("unityContainer");
				container.style.width = window.innerWidth + "px";
				container.style.height = window.innerHeight + "px";
			}
			Promise.all([mergeFiles(getParts("game.zip", 1, 13))]).then(
				([gameUrl]) => {
					document.getElementById("loadingText").remove();
					document.getElementById("game").style.display = "none";
					document.getElementById("game").style.display = "block";
					window.EJS_player = "#game";
					window.EJS_core = "psp";
					window.EJS_threads = true;
					window.EJS_gameUrl = gameUrl;
					window.EJS_pathtodata = "https://cdn.emulatorjs.org/stable/data/";

					const script = document.createElement("script");
					script.src = "https://cdn.emulatorjs.org/stable/data/loader.js";
					document.body.appendChild(script);
				}
			);
		</script>
	</body>
</html>
