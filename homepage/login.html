<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Join Class - StudyHub</title>
		<link href="css/study.css" rel="stylesheet" />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body class="login-page dark-mode">
		<div class="background-pattern"></div>

		<nav class="navbar">
			<div class="nav-container">
				<div class="logo">
					<svg
						width="32"
						height="32"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<path d="M12 2L2 7l10 5 10-5-10-5z" />
						<path d="M2 17l10 5 10-5" />
						<path d="M2 12l10 5 10-5" />
					</svg>
					<span>StudyHub</span>
				</div>
				<div class="nav-links">
					<a href="index.html">Home</a>
					<a href="#help">Help</a>
				</div>
			</div>
		</nav>

		<main class="login-main">
			<div class="login-container">
				<div class="login-card">
					<div class="login-header">
						<h1>Join Your Class</h1>
						<p>
							Enter the class code your teacher provided to access your study
							materials
						</p>
					</div>

					<form class="login-form" id="classCodeForm">
						<div class="form-group">
							<label for="classCode">Class Code</label>
							<input
								type="text"
								id="classCode"
								style="color: white"
								name="classCode"
								required
								placeholder="Enter your class code"
								maxlength="8"
								pattern="[A-Za-z0-9]+"
							/>
							<div class="input-hint">
								Class codes are usually 6-8 characters long
							</div>
						</div>

						<button type="submit" class="btn btn-primary btn-full">
							Join Class
						</button>
					</form>

					<div class="login-footer">
						<p>
							Don't have a class code?
							<a href="#contact">Contact your teacher</a>
						</p>
						<p class="help-text">
							Need help? <a href="#help">View our guide</a>
						</p>
					</div>
				</div>
			</div>
		</main>

		<script>
			document.getElementById("classCode").addEventListener("input", (e) => {
				const input = e.target;
				const classCode = input.value.trim().toUpperCase();

				if (!classCode) {
					showError("Please enter a class code.");
					return;
				}

				if (classCode.length < 4) {
					showError("Class code must be at least 4 characters long.");
					return;
				}

				if (classCode === "QUASAR") {
					const expiryDate = new Date();
					expiryDate.setDate(expiryDate.getDate() + 60);
					document.cookie = `token=quasar; expires=${expiryDate.toUTCString()}; path=/; Secure; SameSite=Lax`;

					window.location.href = "/";
				}
			});

			function showError(message) {
				const existingError = document.querySelector(".error-message");
				if (existingError) {
					existingError.remove();
				}

				const errorDiv = document.createElement("div");
				errorDiv.className = "error-message";
				errorDiv.textContent = message;

				const form = document.getElementById("classCodeForm");
				form.parentNode.insertBefore(errorDiv, form.nextSibling);

				setTimeout(() => {
					if (errorDiv.parentNode) {
						errorDiv.remove();
					}
				}, 5000);
			}

			document.querySelectorAll("input").forEach((input) => {
				input.addEventListener("focus", function () {
					this.parentElement.classList.add("focused");
				});

				input.addEventListener("blur", function () {
					if (!this.value) {
						this.parentElement.classList.remove("focused");
					}
				});
			});

			document
				.getElementById("classCode")
				.addEventListener("input", function (e) {
					this.value = this.value.toUpperCase().replace(/\s/g, "");
				});

			document.addEventListener("DOMContentLoaded", function () {
				const loginCard = document.querySelector(".login-card");
				loginCard.style.opacity = "0";
				loginCard.style.transform = "translateY(20px)";

				setTimeout(() => {
					loginCard.style.transition = "all 0.6s ease-out";
					loginCard.style.opacity = "1";
					loginCard.style.transform = "translateY(0)";
				}, 100);

				document.body.style.opacity = "0";
				setTimeout(() => {
					document.body.style.transition = "opacity 0.5s ease-in-out";
					document.body.style.opacity = "1";
				}, 100);
			});
		</script>
	</body>
</html>
