<html>
	<head>
		<title>Quasar DS Loader</title>
		<style>
			body {
				overflow: hidden;
				background: #000000;
				margin-top: 0;
				margin-left: 0;
				color: #000000;
			}

			#startButton {
				display: block;
				width: 160px;
				height: 40px;
				background-color: #4caf50;
				color: white;
				text-align: center;
				text-decoration: none;
				font-size: 16px;
				margin: 20px auto;
				padding: 10px 20px;
				border: none;
				border-radius: 8px;
				cursor: pointer;
				font-family: "Press Start 2P", cursive;
				box-shadow: 0px 0px 10px 2px #000000;
			}
		</style>
		<style type="text/css">
			#button {
				display: none;
			}

			.imgb_vis {
				animation: imgb-animation 7s linear;
			}

			@keyframes imgb-animation {
				10% {
					transform: translateX(0);
				}

				20% {
					transform: translateX(100px);
				}

				90% {
					transform: translateX(100px);
				}

				100% {
					transform: translateX(0);
				}
			}
		</style>
	</head>

	<body>
		<h1 style="text-align: center; font-size: 48px; color: white">LOADING</h1>
		<div style="width: 100vw; height: 100vh; max-width: 100%">
			<div id="game" style="display: none"></div>
		</div>
		<script>
			function mergeFiles(fileParts) {
				return new Promise((resolve, reject) => {
					let buffers = [];

					function fetchPart(index) {
						if (index >= fileParts.length) {
							let mergedBlob = new Blob(buffers);
							let mergedFileUrl = URL.createObjectURL(mergedBlob);
							resolve(mergedFileUrl);
							return;
						}
						fetch(fileParts[index])
							.then((response) => response.arrayBuffer())
							.then((data) => {
								buffers.push(data);
								fetchPart(index + 1);
							})
							.catch(reject);
					}
					fetchPart(0);
				});
			}

			function getParts(file, start, end) {
				let parts = [];
				for (let i = start; i <= end; i++) {
					parts.push(file + ".part" + i);
				}
				return parts;
			}

			Promise.all([mergeFiles(getParts("game.7z", 1, 2))]).then(([gameUrl]) => {
				document.querySelector("h1").remove();
				document.getElementById("game").style.display = "none";
				document.getElementById("game").style.display = "block";
				window.EJS_player = "#game";
				window.EJS_core = "nds";
				window.EJS_gameUrl = gameUrl;
				window.EJS_pathtodata = "https://cdn.emulatorjs.org/stable/data/";

				const script = document.createElement("script");
				script.src = "https://cdn.emulatorjs.org/stable/data/loader.js";
				document.body.appendChild(script);
			});
		</script>
	</body>
</html>
